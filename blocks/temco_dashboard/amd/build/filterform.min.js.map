{"version":3,"file":"filterform.min.js","sources":["../src/filterform.js"],"sourcesContent":["import * as DynamicTable from 'core_table/dynamic';\nimport * as Notification from 'core/notification';\n\nconst SELECTORS = {\n    filterform: '#filterform form',\n};\n\nexport const initTable = () => {\n    const form = document.querySelector(SELECTORS.filterform);\n    if (!form) {\n        return false;\n    }\n    const submitHandler = e => {\n        const {target: triggerelement, submitter} = e;\n        e.preventDefault();\n        const table = DynamicTable.getTableFromId(\"temcouser\");\n        const filterset = DynamicTable.getFilters(table);\n        for (let name in filterset.filters) {\n            if (name in form.elements || `${name}[]` in form.elements) {\n                filterset.filters[name].values = [];\n            }\n        }\n        let refreshTable = false;\n        [...form.elements].forEach(formelement => {\n            const name = formelement.name.replace('[]', '');\n            if (!(name in filterset.filters)) {\n                return;\n            }\n            if (formelement instanceof HTMLSelectElement) {\n                [...formelement.selectedOptions]\n                    .map(option => filterset.filters[name].values.push(parseInt(option.value)));\n                if (!refreshTable) {\n                    refreshTable = formelement === triggerelement;\n                }\n            } else if (formelement instanceof HTMLInputElement) {\n                if (formelement.type === 'checkbox' && !formelement.checked) {\n                    return;\n                }\n                filterset.filters[name].values.push(formelement.value);\n                if (!refreshTable) {\n                    refreshTable = formelement === triggerelement && formelement.type === 'text';\n                }\n            }\n        });\n        if (refreshTable || submitter) {\n            DynamicTable.setFilters(table, filterset)\n                .then(tableRoot => tableRoot.setAttribute('data-ajaxloaded', 1))\n                .catch(Notification.exception);\n        }\n        return false;\n    };\n\n    form.addEventListener('submit', submitHandler);\n    return true;\n};\n"],"names":["SELECTORS","form","document","querySelector","addEventListener","e","target","triggerelement","submitter","preventDefault","table","DynamicTable","getTableFromId","filterset","getFilters","name","filters","elements","values","refreshTable","forEach","formelement","replace","HTMLSelectElement","selectedOptions","map","option","push","parseInt","value","HTMLInputElement","type","checked","setFilters","then","tableRoot","setAttribute","catch","Notification","exception"],"mappings":"kwCAGMA,qBACU,sCAGS,WACfC,KAAOC,SAASC,cAAcH,0BAC/BC,YACM,SA0CXA,KAAKG,iBAAiB,UAxCAC,UACXC,OAAQC,eAATC,UAAyBA,WAAaH,EAC5CA,EAAEI,uBACIC,MAAQC,aAAaC,eAAe,aACpCC,UAAYF,aAAaG,WAAWJ,WACrC,IAAIK,QAAQF,UAAUG,SACnBD,QAAQd,KAAKgB,UAAY,UAAGF,aAAYd,KAAKgB,YAC7CJ,UAAUG,QAAQD,MAAMG,OAAS,QAGrCC,cAAe,YACflB,KAAKgB,UAAUG,SAAQC,oBACjBN,KAAOM,YAAYN,KAAKO,QAAQ,KAAM,OACtCP,QAAQF,UAAUG,WAGpBK,uBAAuBE,sBACnBF,YAAYG,iBACXC,KAAIC,QAAUb,UAAUG,QAAQD,MAAMG,OAAOS,KAAKC,SAASF,OAAOG,UAClEV,eACDA,aAAeE,cAAgBd,qBAEhC,GAAIc,uBAAuBS,iBAAkB,IACvB,aAArBT,YAAYU,OAAwBV,YAAYW,eAGpDnB,UAAUG,QAAQD,MAAMG,OAAOS,KAAKN,YAAYQ,OAC3CV,eACDA,aAAeE,cAAgBd,gBAAuC,SAArBc,YAAYU,WAIrEZ,cAAgBX,YAChBG,aAAasB,WAAWvB,MAAOG,WAC1BqB,MAAKC,WAAaA,UAAUC,aAAa,kBAAmB,KAC5DC,MAAMC,aAAaC,YAErB,MAIJ"}