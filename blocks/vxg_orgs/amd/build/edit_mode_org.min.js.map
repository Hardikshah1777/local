{"version":3,"file":"edit_mode_org.min.js","sources":["../src/edit_mode_org.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\ndefine([\"jquery\"], function($) {\n    return {\n        init: function() {\n            $(\"#orgs_tree .tree_item\").click(function() {\n                $('#orgs_tree [aria-selected=\"true\"]').attr(\"aria-selected\", \"false\");\n            });\n\n            $(\"#vxg_search_orgs\")\n                .parent()\n                .on(\"click\", \"[role=option]\", function() {\n                    var orgid = $(this).attr(\"data-value\");\n                    $(\"#orgs_tree [aria-selected=true]\").attr(\"aria-selected\", \"false\");\n                    var treeitem = $(\"#orgs_tree [data-orgid=\" + orgid + \"]\");\n                    treeitem.attr(\"aria-selected\", \"true\");\n                    treeitem.parents().attr(\"aria-hidden\", \"false\");\n                    treeitem\n                        .parents()\n                        .siblings('[aria-expanded=\"false\"]')\n                        .attr(\"aria-expanded\", \"true\");\n                });\n            // Add org admin.\n            var orgadminNewa = $(\"#vxg_org_addadmin_btn\");\n            var orgadminNewUrlStart = orgadminNewa.attr(\"href\");\n\n            // view org admin.\n            var orgadminview = $(\"#vxg_org_viewadmin_btn\");\n            var orgadmiviewUrlStart = orgadminview.attr(\"href\");\n\n            var org = $(\"#orgs_tree\").find(\".tree_item\");\n\n            var adminUrl = orgadminNewUrlStart + \"&orgid=0\";\n            orgadminNewa.attr(\"href\", adminUrl);\n\n            var adminvUrl = orgadmiviewUrlStart + \"&orgid=0\";\n            orgadminview.attr(\"href\", adminvUrl);\n\n            var orgId = 0;\n            org.click(function() {\n                orgId = $(this).attr(\"data-orgid\");\n                makeAddOrgadminUrl(orgId, orgadminNewa, orgadminNewUrlStart);\n            });\n\n            var orgvId = 0;\n            org.click(function() {\n                orgvId = $(this).attr(\"data-orgid\");\n                makeAddOrgadminUrl(orgvId, orgadminview, orgadmiviewUrlStart);\n            });\n\n            // Add.\n            var orgNewa = $(\"#vxg_org_new_btn\");\n            var orgNewUrlStart = orgNewa.attr(\"href\");\n\n            var newUrl = orgNewUrlStart + \"&orgid=0\";\n            orgNewa.attr(\"href\", newUrl);\n\n            org.click(function() {\n                orgId = $(this).attr(\"data-orgid\");\n                makeAddOrgUrl(orgId, orgNewa, orgNewUrlStart);\n            });\n            // Edit.\n            var orgedita = $(\"#vxg_org_edit_btn\");\n\n            var orgEditUrlStart = orgedita.attr(\"href\");\n\n            org.click(function() {\n                orgId = $(this).attr(\"data-orgid\");\n                makeEditOrgUrl(orgId, orgedita, orgEditUrlStart);\n            });\n            // Delete.\n            var orgdela = $(\"#vxg_org_del_btn\");\n            var orgDelUrlStart = orgdela.attr(\"href\");\n\n            org.click(function() {\n                orgId = $(this).attr(\"data-orgid\");\n                makeDeleteOrgUrl(orgId, orgdela, orgDelUrlStart);\n            });\n\n            var toggleSearchBtn = $(\".vxg-search-org-btn\");\n            toggleSearchBtn.click(function() {\n                // Toggle search hide/show.\n                $(\"#vxg_search_orgs\").toggleClass(\"vxg_search_orgs\");\n\n                // Add click event to li elements in the suggestions list.\n                var suggestionsElement = $(\"#vxg_search_orgs\");\n                suggestionsElement.parent().on(\"click\", \"[role=option]\", function(e) {\n                    var element = $(e.currentTarget).closest(\"[role=option]\");\n                    var orgId = element.attr(\"data-value\");\n\n                    makeAddOrgadminUrl(orgId, orgadminNewa, orgadminNewUrlStart);\n                    makeAddOrgadminUrl(orgvId, orgadminview, orgadmiviewUrlStart);\n                    makeAddOrgUrl(orgId, orgNewa, orgNewUrlStart);\n                    makeDeleteOrgUrl(orgId, orgdela, orgDelUrlStart);\n                    makeEditOrgUrl(orgId, orgedita, orgEditUrlStart);\n                });\n            });\n        }\n    };\n\n    /**\n     * Controls the url for the delete button.\n     * @param {int} orgId\n     * @param {object} orgdela\n     * @param {String} orgDelUrlStart\n     */\n    function makeDeleteOrgUrl(orgId, orgdela, orgDelUrlStart) {\n        if (orgId != 0) {\n            var delUrl = orgDelUrlStart + \"&orgid=\" + orgId;\n            orgdela.attr(\"href\", delUrl);\n            orgdela.children().removeAttr(\"disabled\");\n            orgdela.children().css(\"pointer-events\", \"initial\");\n        } else {\n            orgdela.children().attr(\"disabled\", true);\n            orgdela.children().css(\"pointer-events\", \"none\");\n        }\n    }\n\n    /**\n     * Controls the url for the edit button.\n     * @param {int} orgId\n     * @param {object} orgedita\n     * @param {String} orgEditUrlStart\n     */\n    function makeEditOrgUrl(orgId, orgedita, orgEditUrlStart) {\n        if (orgId != 0) {\n            var editUrl = orgEditUrlStart + \"&orgid=\" + orgId;\n            orgedita.attr(\"href\", editUrl);\n            orgedita.children().removeAttr(\"disabled\");\n            orgedita.children().css(\"pointer-events\", \"initial\");\n        } else {\n            orgedita.children().attr(\"disabled\", true);\n            orgedita.children().css(\"pointer-events\", \"none\");\n        }\n    }\n\n    /**\n     * Controls the url for the new button.\n     * @param {int} orgId\n     * @param {object} orgNewa\n     * @param {String} orgNewUrlStart\n     */\n    function makeAddOrgUrl(orgId, orgNewa, orgNewUrlStart) {\n        var newUrl = orgNewUrlStart + \"&orgid=\" + orgId;\n        orgNewa.attr(\"href\", newUrl);\n        orgNewa.children().removeAttr(\"disabled\");\n        orgNewa.children().css(\"pointer-events\", \"initial\");\n    }\n\n    /**\n     * Controls the url for the orgadmin button.\n     * @param {int} orgId\n     * @param {object} orgadminNewa\n     * @param {String} orgadminNewUrlStart\n     */\n    function makeAddOrgadminUrl(orgId, orgadminNewa, orgadminNewUrlStart) {\n        if (orgId != 0) {\n            var adminUrl = orgadminNewUrlStart + \"&orgid=\" + orgId;\n            orgadminNewa.attr(\"href\", adminUrl);\n            orgadminNewa.children().removeAttr(\"disabled\");\n            orgadminNewa.children().css(\"pointer-events\", \"initial\");\n        } else {\n            orgadminNewa.children().attr(\"disabled\", true);\n            orgadminNewa.children().css(\"pointer-events\", \"none\");\n        }\n    }\n});\n"],"names":["define","$","init","click","attr","parent","on","orgid","this","treeitem","parents","siblings","orgadminNewa","orgadminNewUrlStart","orgadminview","orgadmiviewUrlStart","org","find","adminUrl","adminvUrl","makeAddOrgadminUrl","orgvId","orgNewa","orgNewUrlStart","newUrl","makeAddOrgUrl","orgedita","orgEditUrlStart","makeEditOrgUrl","orgdela","orgDelUrlStart","makeDeleteOrgUrl","toggleClass","e","orgId","currentTarget","closest","delUrl","children","removeAttr","css","editUrl"],"mappings":"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"}