define("local_test1/test1",["exports","core_table/dynamic"],(function(_exports,DynamicTable){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,DynamicTable=function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(i.get||i.set)?o(f,t,i):f[t]=e[t]);return f}(e,t)}(DynamicTable);function showToast(message,isSuccess,toasttype){let title=null,toast=!1,icon=isSuccess?"success":"error";toasttype.includes("isEmail")&&(title=isSuccess?"Mail Send":"Mail Not Send"),toasttype.includes("ispdf")&&(title=isSuccess?"Attachment Send":"Attachment Not Send"),toasttype.includes("resendmail")&&(title=isSuccess?"Mail Re-Send":"Mail Not Send",toast=!0,icon=""),message.includes("CSV")&&(toast=!0,icon=""),Swal.fire({title:title,text:message,icon:icon,showConfirmButton:!1,confirmButtonText:"OK",showCancelButton:!1,cancelButtonText:"Cancle",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",iconColor:"#d33",timer:3e3,toast:toast,timerProgressBar:!0,allowEscapeKey:!1})}_exports.init=()=>{window.console.log("--------------- Test 1 js working ---------------")},document.querySelectorAll(".maillink").forEach((link=>{link.addEventListener("click",(function(event){event.preventDefault();const userid=this.getAttribute("data-uid");fetch(M.cfg.wwwroot+"/local/test1/testmail.php",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({uid:userid})}).then((response=>response.json())).then((data=>{data.success?showToast("Email successfully sent to "+data.username,data.success,"isEmail"):showToast("Failed to send Email",data.success,"isEmail")})).catch((error=>{window.console.log(error),showToast("An error occurred while sending the email.",!1,"isEmail")}))}))})),document.querySelectorAll(".downloadpdf").forEach((link=>{link.addEventListener("click",(function(event){event.preventDefault();const user=JSON.parse(this.getAttribute("data-user")),tr=this.closest("tr");if(!tr)return void window.console.error("Row not found");const rowData=Array.from(tr.children).map((td=>td.textContent.trim())).slice(1),{jsPDF:jsPDF}=window.jspdf,doc=new jsPDF;doc.setFontSize(16),doc.text("User Information.",80,15),doc.autoTable({head:[["Name","Email","City","Date"]],body:[rowData],startY:20});const filename=user.firstname+" "+user.lastname+".pdf",blob=doc.output("blob"),formData=new FormData;formData.append("pdf",blob,filename),formData.append("userid",user.id),fetch(M.cfg.wwwroot+"/local/test1/testmail.php",{method:"POST",body:formData}).then((response=>response.json())).then((result=>{result.success?(showToast("PDF sent to "+result.username,result.success,"ispdf"),doc.save(filename)):showToast("Failed to send PDF ",result.success,"ispdf")})).catch((error=>{window.console.log(error),showToast("Error sending PDF in send mail",!1,"ispdf")}))}))})),document.querySelectorAll(".downloadcsv").forEach((link=>{link.addEventListener("click",(function(event){event.preventDefault();const user=JSON.parse(this.getAttribute("data-user")),tr=this.closest("tr");if(!tr)return void window.error("Row not found");const rowData=Array.from(tr.children).map((td=>td.textContent.trim())).slice(1),csvContent=[["Name","Email","City","Date"].join(","),rowData.join(",")].join("\n"),blob=new Blob([csvContent],{type:"text/csv;charset=utf-8;"}),url=URL.createObjectURL(blob),a=document.createElement("a");let filename=user.firstname+" "+user.lastname+".csv";a.setAttribute("href",url),a.setAttribute("download",filename),a.style.display="none",document.body.appendChild(a),a.click(),showToast("CSV Exported successfully...",!0,"iscsv"),document.body.removeChild(a),URL.revokeObjectURL(url)}))})),require(["core/modal_factory","jquery","jqueryui"],(function(ModalFactory,$){document.querySelectorAll(".viewmail").forEach((function(link){link.addEventListener("click",(function(event){event.preventDefault();const user=JSON.parse(this.getAttribute("data-user"));let type=(null==user?void 0:user.type)||" General ",title=(null==user?void 0:user.subject)||"No Subject",body=(null==user?void 0:user.body)||"Nothing to display";title="Subject : "+title,type&&(type="<p><b>Type : "+type+" </b></p><hr>"),ModalFactory.create({title:title,body:type+" "+body,large:!0,closeButton:!1,footer:'<button type="submit" class="btn btn-primary cancel-btn">Cancel</button>'}).then((function(modal){const $modal=modal.getModal();$modal.addClass("custom-viewmail-modal"),$modal.find(".modal-content").hide().fadeIn(500),modal.show().then((function(){const $backdrop=$(".modal-backdrop");$backdrop.css("opacity","0"),setTimeout((()=>{$backdrop.addClass("show"),$backdrop.css("opacity","0.5")}),10)})),$modal.draggable({handle:".modal-header"}),$modal.find(".modal-content").css({resize:"both"}),$modal.on("click",".cancel-btn",(function(e){e.preventDefault();const $backdrop=$(".modal-backdrop");$modal.find(".modal-content").animate({opacity:0},500,(function(){$backdrop.css("opacity","0"),setTimeout((()=>{"function"==typeof modal.hide?modal.hide():"function"==typeof modal.close?modal.close():$modal.hide()}),500)}))}))}))}))}))})),document.querySelectorAll(".resendmail").forEach((link=>{link.addEventListener("click",(function(event){event.preventDefault();let logid1=JSON.parse(this.getAttribute("data-user")).id;fetch(M.cfg.wwwroot+"/local/test1/testmail.php",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({logid:logid1})}).then((response=>response.json())).then((data=>{if(data.success){showToast("Mail Re-send to "+data.fullname,data.success,"resendmail");let dt=document.querySelector(".table-dynamic");DynamicTable.refreshTableContent(DynamicTable.getTableFromId(dt.dataset.tableUniqueid))}else showToast("Mail Failed to Re-send",data.success,"resendmail")})).catch((error=>{window.console.log(error),showToast("An error occurred while Re-sending the mail",!1,"resendmail")}))}))}))}));

//# sourceMappingURL=test1.min.js.map