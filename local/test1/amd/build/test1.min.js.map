{"version":3,"file":"test1.min.js","sources":["../src/test1.js"],"sourcesContent":["export const init = () => {\n    window.console.log('--------------- Test 1 js working ---------------');\n};\n/**\n * Description of showToast.\n * @param {string} message - The message for show in swal.\n * @param {boolean} isSuccess - Indicates success or failure user email.\n * @param {string} toasttype - Indicates pdf send in user email.\n */\nfunction showToast(message, isSuccess, toasttype) {\n    // const toast = document.getElementById('toast');\n    // toast.textContent = message;\n    // toast.style.backgroundColor = isSuccess ? '#b3ffae' : '#ffe0e0';\n    // toast.className = 'show d-flex justify-content-center p-2';\n    // setTimeout(() => {\n    //     toast.className = 'toast ';\n    // }, 2000);\n    let title = null;\n    let toast = false;\n    let icon = isSuccess ? 'success' : 'error';\n\n    if (toasttype.includes('isEmail')) {\n        title = isSuccess ? 'Mail Send' : 'Mail Not Send';\n    }\n    if (toasttype.includes('ispdf')) {\n        title = isSuccess ? 'Attachment Send' : 'Attachment Not Send';\n    }\n    if (toasttype.includes('resendmail')) {\n        title = isSuccess ? 'Mail Re-Send' : 'Mail Not Send';\n        toast = true;\n        icon = '';\n    }\n\n    if (message.includes('CSV')) {\n        toast = true;\n        icon = '';\n    }\n\n    Swal.fire({\n        title: title,\n        text: message,\n        icon: icon,\n        showConfirmButton: false,\n        confirmButtonText: 'OK',\n        showCancelButton: false,\n        cancelButtonText: 'Cancle',\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor:'#d33',\n        iconColor:'#d33',\n        timer: 3000,\n        toast: toast,\n        timerProgressBar:true,\n        //allowOutsideClick:true,\n        allowEscapeKey:false,\n        //allowEnterKey:true,\n    });\n}\n\ndocument.querySelectorAll('.maillink').forEach(link => {\n    link.addEventListener('click', function(event) {\n        event.preventDefault();\n        const userid = this.getAttribute('data-uid');\n        fetch(M.cfg.wwwroot +'/local/test1/testmail.php', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-Requested-With': 'XMLHttpRequest',\n            },\n            body: JSON.stringify({ uid: userid })\n        }).then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    showToast('Email successfully sent to ' + data.username, data.success, 'isEmail');\n                } else {\n                    showToast('Failed to send Email', data.success, 'isEmail');\n                }\n            }).catch(error => {\n            window.console.log(error);\n                showToast('An error occurred while sending the email.', false, 'isEmail');\n        });\n    });\n});\n\ndocument.querySelectorAll('.downloadpdf').forEach(link => {\n    link.addEventListener('click', function(event) {\n        event.preventDefault();\n        const user = JSON.parse(this.getAttribute('data-user'));\n        const tr = this.closest('tr');\n        if (!tr) {\n            window.console.error(\"Row not found\");\n            return;\n        }\n\n        const headers = [\"Name\", \"Email\", \"City\", \"Date\"];\n        const rowData = Array.from(tr.children).map(td => td.textContent.trim()).slice(1);\n\n        const { jsPDF } = window.jspdf;\n        const doc = new jsPDF();\n\n        const title = \"User Information.\";\n        doc.setFontSize(16);\n        doc.text(title, 80, 15);\n\n        doc.autoTable({ head: [headers], body: [rowData], startY: 20 });\n\n        const filename = user.firstname + ' ' + user.lastname + '.pdf';\n\n        const blob = doc.output('blob'); // sync\n        const formData = new FormData();\n        formData.append('pdf', blob, filename);\n        formData.append('userid', user.id);\n\n        fetch(M.cfg.wwwroot +'/local/test1/testmail.php', {\n            method: 'POST',\n            body: formData\n        }).then(response => response.json())\n            .then(result => {\n                if (result.success) {\n                    showToast('PDF sent to ' + result.username, result.success, 'ispdf');\n                    doc.save(filename);\n                } else {\n                    showToast('Failed to send PDF ', result.success, 'ispdf');\n                }\n            }).catch(error => {\n                window.console.log(error);\n                showToast('Error sending PDF in send mail', false, 'ispdf');\n        });\n    });\n});\n\ndocument.querySelectorAll('.downloadcsv').forEach(link => {\n    link.addEventListener('click', function(event) {\n        event.preventDefault();\n        const user = JSON.parse(this.getAttribute('data-user'));\n        const tr = this.closest('tr');\n        if (!tr) {\n            window.error(\"Row not found\");\n            return;\n        }\n\n        const headers = [\"Name\", \"Email\", \"City\", \"Date\"];\n        const rowData = Array.from(tr.children).map(td => td.textContent.trim()).slice(1);\n\n        const csvContent = [ headers.join(','), rowData.join(',') ].join(\"\\n\");\n\n        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        let filename = user.firstname + ' ' + user.lastname + '.csv';\n        a.setAttribute('href', url);\n        a.setAttribute('download', filename);\n        a.style.display = 'none';\n        document.body.appendChild(a);\n        a.click();\n        showToast('CSV Exported successfully...',true, 'iscsv');\n        document.body.removeChild(a);\n        URL.revokeObjectURL(url);\n    });\n});\n\nrequire(['core/modal_factory'], function(ModalFactory) {\n    document.querySelectorAll('.viewmail').forEach(function(link) {\n        link.addEventListener('click', function(event) {\n            event.preventDefault();\n\n            const user = JSON.parse(this.getAttribute('data-user'));\n            let type = user?.type || ' ';\n            let title = user?.subject || 'No Subject';\n            let body = user?.body || 'Nothing to display';\n            title = 'Subject : ' + title;\n            if (type) {\n                type = '<b>Type : ' + type + ' </b> <br><hr>';\n            }\n            ModalFactory.create({\n                title: title,\n                body: type + ' ' + body,\n                large: true,\n                closeButton: false,\n                footer: 'footer',\n            }).then(function(modal) {\n                modal.getModal().addClass('custom-viewmail-modal');\n                modal.show();\n            });\n        });\n    });\n});\n\ndocument.querySelectorAll('.resendmail').forEach(link => {\n    link.addEventListener('click', function(event) {\n        event.preventDefault();\n        const user = JSON.parse(this.getAttribute('data-user'));\n        let logid1 = user.id;\n\n        fetch(M.cfg.wwwroot +'/local/test1/testmail.php', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-Requested-With': 'XMLHttpRequest',\n            },\n            body: JSON.stringify({ logid: logid1 }),\n        }).then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    showToast('Mail Re-send to ' + data.fullname, data.success, 'resendmail');\n                } else {\n                    showToast('Mail Failed to Re-send', data.success, 'resendmail');\n                }\n            }).catch(error => {\n                    window.console.log(error);\n                    showToast('An error occurred while Re-sending the mail',false, 'resendmail');\n        });\n    });\n});"],"names":["showToast","message","isSuccess","toasttype","title","toast","icon","includes","Swal","fire","text","showConfirmButton","confirmButtonText","showCancelButton","cancelButtonText","confirmButtonColor","cancelButtonColor","iconColor","timer","timerProgressBar","allowEscapeKey","_exports","init","window","console","log","document","querySelectorAll","forEach","link","addEventListener","event","preventDefault","userid","this","getAttribute","fetch","M","cfg","wwwroot","method","headers","body","JSON","stringify","uid","then","response","json","data","success","username","catch","error","user","parse","tr","closest","rowData","Array","from","children","map","td","textContent","trim","slice","jsPDF","jspdf","doc","setFontSize","autoTable","head","startY","filename","firstname","lastname","blob","output","formData","FormData","append","id","result","save","csvContent","join","Blob","type","url","URL","createObjectURL","a","createElement","setAttribute","style","display","appendChild","click","removeChild","revokeObjectURL","require","ModalFactory","subject","create","large","closeButton","footer","modal","getModal","addClass","show","logid1","logid","fullname"],"mappings":"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"}