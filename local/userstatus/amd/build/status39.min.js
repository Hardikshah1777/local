define ("local_userstatus/status39",["jquery","core/str","core/modal_factory","core/modal_events","core/templates","core/notification","core/config","core_table/dynamic"],function(a,b,c,d,e,f,g,h){var i={BULKACTIONSELECT:"#formactionid",BULKUSERCHECKBOXES:"input[data-togglegroup='participants-table'][data-toggle='slave']",BULKUSERSELECTEDCHECKBOXES:"input[data-togglegroup='participants-table'][data-toggle='slave']:checked",BULKACTIONFORM:"#participantsform",STATUSCHANGER:"#statuschanger"},j=g.wwwroot+"/local/userstatus/ajax.php",k=function(a){return"form[data-table-unique-id=\"".concat(a,"\"]")},l=function(a){this.courseId=a.courseid;this.statuses=a.statuses;this.selectbox=null;this.attachEventListeners()};l.prototype.courseId=-1;l.prototype.selectbox=null;l.prototype.attachEventListeners=function(){if(0<a(i.BULKACTIONSELECT).length){a(i.BULKACTIONFORM).attr("data-enhanced",!0);var c={sesskey:g.sesskey,id:this.courseId,userids:[],action:"get"};b.get_strings([{key:"changestatus",component:"local_userstatus"},{key:"choose"}]).then(function(b){if(!this.selectbox){var d=a("<label for=\"statuschanger\" class=\"col-form-label d-inline ml-2\">"+b[0]+"</label>");d.insertAfter(a(i.BULKACTIONSELECT));var e=a("<select id=\"statuschanger\" class=\"custom-select\" disabled></select>");e.append("<option value=\"\">"+b[1]+"</option>");a.each(this.statuses,function(a,b){e.append("<option value=\""+a+"\">"+b+"</option>")});e.insertAfter(d);e.on("change",function(b){c.status=a(b.target).val();c.userids=[];var d={};a(i.BULKUSERSELECTEDCHECKBOXES).each(function(b,e){var f=e.name.replace("user","");c.userids.push(f);d[f]=a(e).parents("tr")});if(0===c.userids.length||""===c.status){return}a.post(j,c).done(function(b){if(b.success&&b.users){a.each(b.users,function(a,b){d[a].find("[data-statusid]").replaceWith(b)})}this.selectbox.val("")}.bind(this))}.bind(this));this.selectbox=e}var f={};a(i.BULKUSERCHECKBOXES).each(function(b,d){var e=d.name.replace("user","");c.userids.push(e);f[e]=a(d).parents("tr")}).on("change",function(){this.selectbox.prop("disabled",0===a(i.BULKUSERSELECTEDCHECKBOXES).length)}.bind(this));if(0<c.userids.length){a.post(j,c).done(function(b){if(b.success&&b.users){a.each(b.users,function(a,b){f[a].find(".c1").append(b)})}c.action="put";c.userids=[]})}}.bind(this))}};l.prototype.refreshTable=function(){this.attachEventListeners()};return{init:function init(a){var b,c;if(a.uniqueid){b=document.querySelector(k(a.uniqueid));i.BULKACTIONFORM=b}c=new l(a);if(b){b.addEventListener(h.Events.tableContentRefreshed,function(){c.refreshTable()})}return c}}});
//# sourceMappingURL=status39.min.js.map
