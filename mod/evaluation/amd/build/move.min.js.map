{"version":3,"sources":["../src/move.js"],"names":["define","$","SortableList","Ajax","Notification","init","sort","targetListSelector","getElementName","element","Deferred","resolve","attr","on","EVENTS","DRAGSTART","_","info","setTimeout","width","DROP","sourcesection","sourceList","dataset","saferskill","destinysection","targetList","listsection","children","sourcelistsection","data","i","length","push","sectionid","getAttribute","position","saferid","window","console","log","positionChanged","call","methodname","args","action","fail","exception"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\ndefine(['jquery', 'core/sortable_list', 'core/ajax', 'core/notification'], function($, SortableList, Ajax, Notification) {\n    return {\n        init: function() {\n            // Initialise sortable for the given list.\n            var sort = new SortableList('.skillsectionwrapper', {targetListSelector: '.skillsectionwrapper'});\n            sort.getElementName = function(element) {\n                return $.Deferred().resolve(element.attr('data-name'));\n            };\n            $('.skillsectionwrapper .sectionwrapper').on(SortableList.EVENTS.DRAGSTART, function(_, info) {\n                setTimeout(function() {\n                    $('.sortable-list-is-dragged').width(info.element.width());\n                }, 501);\n            }).on(SortableList.EVENTS.DROP, function(_, info) {\n                var sourcesection = info.sourceList[0].dataset.saferskill;\n                var destinysection = info.targetList[0].dataset.saferskill;\n                var listsection = info.targetList[0].children;\n                var sourcelistsection = info.sourceList[0].children;\n                var data = [];\n                if (sourcesection == 0 && destinysection == 0) {\n                    for (let i = 0; i < listsection.length - 1; i++) {\n                        data.push({sectionid: listsection[i].getAttribute('data-id'), position: i, saferid: 0});\n                    }\n                } else if (sourcesection == 1 && destinysection == 1) {\n                    for (let i = 0; i < listsection.length - 1; i++) {\n                        data.push({sectionid: listsection[i].getAttribute('data-id'), position: i, saferid: 1});\n                    }\n                } else if (sourcesection == 0 && destinysection == 1) {\n                        for (let i = 0; i < sourcelistsection.length; i++) {\n                            data.push({sectionid: sourcelistsection[i].getAttribute('data-id'), position: i, saferid: 0});\n                        }\n                        for (let i = 0; i < listsection.length; i++) {\n                            data.push({sectionid: listsection[i].getAttribute('data-id'), position: i, saferid: 1});\n                        }\n                } else if (sourcesection == 1 && destinysection == 0) {\n                        for (let i = 0; i < sourcelistsection.length; i++) {\n                            data.push({sectionid: sourcelistsection[i].getAttribute('data-id'), position: i, saferid: 1});\n                        }\n                        for (let i = 0; i < listsection.length; i++) {\n                            data.push({sectionid: listsection[i].getAttribute('data-id'), position: i, saferid: 0});\n                        }\n                }\n                window.console.log(data);\n                if (info.positionChanged) {\n                        var request = {\n                            methodname: 'mod_evaluation_invoke_move_action',\n                            args: {\n                                action: 'move_updown_field',\n                                data: data,\n                            }\n                        };\n                        Ajax.call([request])[0].fail(Notification.exception);\n                    }\n            });\n        }\n    };\n});\n"],"file":"move.min.js"}